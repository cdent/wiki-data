{% extends "wikidatabase.html" %}
{% block body %}
{% set fields = commonVars.fields %}
<div id="pagenav">
	<ul>
		<li><a href="/index.html" class="lightborder darkgreen caps">Home</a></li>
		<li><a href="#" class="lightborder darkgreen caps onlyjs" id="backnav">Back</a></li>
	</ul>
</div>

<div id="searchtitle" class="darkgreen">
	<div class="wrap">
		<h2>Search Option</h2>
		<span> - Add company name or unique AVID number to search for a business</span>
	</div>
</div>
<div id="content">
	{% include 'search.html' %}
	<div id="table" class="wrap">
		{% set count = tiddlers|count %}
		{% set from = queryIndex+1 %}
		{% set to = queryIndex+count %}
		{% set count_to_end = resultcount - to %}
		<div id="tableinfo">
			<div id="columnPicker" class="onlyjs">
				<button class="darkgreen whitetext lightborder caps right" id="pickerControl">Hide/Show Columns</button>
				<div id="cols">
					{% for field, label, tooltip in fields %}
					<div class="columns">
						<span class="controls">
							<span class="hideControl">hide</span>|<span class="showControl">show</span>
						</span>
						<span class="label">{{label}}</span>
					</div>
					{% endfor %}
				</div>
			</div>
			<p class="darktext" id="results_count">
			{% if resultcount == 0 -%}
			There are no results - try <span class="filter"><a href="javascript:;">adding a filter</a></span> to include other fields in your search or <a href="/pages/suggest_new">suggest a new record</a>
			{%- else -%}
				{% if resultcount == 1 %}
					There is 1 result
				{%- else -%}
					There are {{resultcount}} results, showing results {{from}} to {{to}}
				{%- endif %}
				 - <span class="filter"><a href="#">add a filter</a>? </span>
				<span id="pageDistance">{{pageDistance}}</span>
				{%- if queryIndex is sameas 0 -%}
					<span class="pagebutton inactive">prev</span>
				{%- else -%}
					<a href="#" class="pagebutton">prev</a>
				{%- endif -%}
				<span class="divider">|</span>
				{%- if count_to_end is sameas 0 -%}
					<span class="pagbutton inactive">next</span>
				{%- else -%}
					<a href="#" class="pagebutton">next</a>				
				{%- endif -%}
			{%- endif %}
			</p>
			<br class="clearboth" />
		</div>
		
		<table id="recordsTable" class="draggable forget-ordering">
			<thead>
				<tr>
				{% for field, label, tooltip in fields %}
					<th title="{{tooltip}}">{{label}}</th>
				{% endfor %}
					<th>Challenge</th>
					<th>Request More Info</th>
				</tr>
			</thead>
			<tfoot>
				<tr>
				{% for field, label, tooltip in fields %}
					<th><a href="javascript:;">hide</a></th>
				{% endfor %}
					<th><a href="javascript:;">hide</a></th>
					<th><a href="javascript:;">hide</a></th>
				</tr>
			</tfoot>
			<tbody>
			{% for tiddler in tiddlers %}
				<tr>
				{% for field, label, tooltip in fields %}
					{% if field == 'avid' %}
					<td><a href="/bags/avox/tiddlers/{{tiddler.title}}.html">{{tiddler.title}}</a></td>
					{% elif field == 'company_website' %}
					<td><a href="{{tiddler.fields[field]}}">{{tiddler.fields[field]}}</a></td>
					{% else %}
					<td>{{tiddler.fields[field]}}</td>
					{% endif %}
				{% endfor %}
					<td><a href="/bags/avox/tiddlers/{{ tiddler.title }}.challenge">go</a></td>
					<td><a href="/bags/avox/tiddlers/{{ tiddler.title }}.request">go</a></td>
				</tr>
			{% endfor %}
			</tbody>
		</table>
	</div>
</div>
{% endblock %}
